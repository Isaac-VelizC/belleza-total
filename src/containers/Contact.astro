---
import SectionFormContact from "@components/SectionFormContact.astro";
import CardContact from "@components/ui/CardContact.astro";
import HeaderSection from "@components/ui/HeaderSection.astro";
---

<section
  id="contact"
  class="relative py-20 bg-gradient-to-br from-background to-white overflow-hidden"
>
  <!-- Background decorative elements -->
  <div class="absolute inset-0 opacity-5">
    <div
      class="absolute top-10 left-10 w-32 h-32 bg-primary rounded-full blur-3xl animate-pulse"
    >
    </div>
    <div
      class="absolute bottom-20 right-20 w-40 h-40 bg-accentcolor rounded-full blur-3xl animate-pulse"
      style="animation-delay: 1s;"
    >
    </div>
    <div
      class="absolute top-1/2 left-1/4 w-24 h-24 bg-secondary rounded-full blur-3xl animate-pulse"
      style="animation-delay: 2s;"
    >
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
    <!-- Header Section -->

    <HeaderSection
      text="Contáctanos"
      titleprimary="Reserva una cita"
      titleColor="con nosotros ya mismo"
      description="Estamos aquí para hacer realidad tu transformación. Contáctanos y vive la mejor experiencia de belleza."
    >
      <span slot="icon" class="w-2 h-2 bg-primary rounded-full animate-pulse"
      ></span>
    </HeaderSection>

    <!-- Main Content Grid -->
    <div class="grid lg:grid-cols-2 gap-12 items-start">
      <!-- Contact Information -->
      <div class="space-y-8 order-2 lg:order-1">
        <!-- Contact Cards -->
        <div class="grid sm:grid-cols-2 gap-6">
          <!-- Email Card -->
          <CardContact title="Email">
            <svg
              slot="icon"
              class="w-6 h-6 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
              ></path>
            </svg>
            <a
              slot="info"
              href="mailto:info@salonbelleza.com"
              class="text-texto/80 hover:text-primary transition-colors duration-200"
            >
              info@salonbelleza.com
            </a>
          </CardContact>

          <!-- Phone Card -->
          <CardContact title="Teléfono">
            <svg
              slot="icon"
              class="w-6 h-6 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
              ></path>
            </svg>
            <a
              slot="info"
              href="tel:+1234567890"
              class="text-texto/80 hover:text-primary transition-colors duration-200"
            >
              +591 234 567 890
            </a>
          </CardContact>

          <!-- Address Card -->
          <CardContact title="Dirección">
            <svg
              slot="icon"
              class="w-6 h-6 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              ></path>
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <p slot="info" class="text-texto/80">
              Av. Principal 123, Centro Comercial<br />
              Plaza Belleza, Local 45
            </p>
          </CardContact>

          <!-- Hours Card -->
          <CardContact title="Horarios">
            <svg
              slot="icon"
              class="w-6 h-6 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <div slot="info" class="text-texto/80 text-sm space-y-1">
              <p>Lun - Vie: 9:00 AM - 7:00 PM</p>
              <p>Sábados: 9:00 AM - 6:00 PM</p>
              <p>Domingos: 10:00 AM - 4:00 PM</p>
            </div>
          </CardContact>
        </div>

        <!-- Map Container -->
        <div
          class="bg-white rounded-2xl overflow-hidden shadow-lg border border-secondary/20"
        >
          <div
            class="h-64 bg-gradient-to-r from-secondary/20 to-accentcolor/20 flex items-center justify-center relative"
          >
            <iframe
              title="Ubicación de la belleza total"
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3826.1234567890!2d-68.1234567890!3d-16.5023456789!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x915f68873d5b57ef%3A0x7a1f3e9a87d12345!2sAv.%20Belleza%20123%2C%20Ciudad!5e0!3m2!1ses!2sbo!4v1234567890123"
              width="100%"
              height="100%"
              style="border:0;"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              class="rounded-2xl"></iframe>
          </div>
        </div>
      </div>

      <!-- Contact Form -->
      <div class="order-1 lg:order-2">
        <SectionFormContact />
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById(
      "contact-form"
    ) as HTMLFormElement | null;
    const successMessage = document.getElementById("success-message");

    if (!form) return;

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const submitButton = form.querySelector(
        'button[type="submit"]'
      ) as HTMLButtonElement;
      const originalText = submitButton.innerHTML;

      submitButton.innerHTML = `
      <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <span>Enviando...</span>
    `;
      submitButton.disabled = true;

      try {
        await new Promise((resolve) => setTimeout(resolve, 2000));

        if (successMessage) {
          successMessage.classList.remove("hidden");
          form.reset();
          setTimeout(() => successMessage.classList.add("hidden"), 5000);
        }
      } catch (error) {
        console.error("Error sending form:", error);
      } finally {
        submitButton.innerHTML = originalText;
        submitButton.disabled = false;
      }
    });

    // Input animations
    const inputs = document.querySelectorAll("input, textarea, select");
    inputs.forEach((input) => {
      input.addEventListener("focus", () =>
        input.parentElement?.classList.add("focused")
      );
      input.addEventListener("blur", () =>
        input.parentElement?.classList.remove("focused")
      );
    });

    // Phone formatting
    const phoneInput = document.getElementById(
      "telefono"
    ) as HTMLInputElement | null;
    if (phoneInput) {
      phoneInput.addEventListener("input", (e) => {
        let value = (e.target as HTMLInputElement).value.replace(/\D/g, "");
        if (value.length >= 6)
          value = value.replace(/(\d{3})(\d{3})(\d{4})/, "($1) $2-$3");
        else if (value.length >= 3)
          value = value.replace(/(\d{3})(\d{0,3})/, "($1) $2");
        (e.target as HTMLInputElement).value = value;
      });
    }
  });
</script>
